<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Convert polygon geometry to dots for dot-density mapping — as_dot_density • tidycensus</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Convert polygon geometry to dots for dot-density mapping — as_dot_density"><meta property="og:description" content="Dot-density maps are a compelling alternative to choropleth maps for cartographic visualization of demographic data as they allow for representation of the internal heterogeneity of geographic units.  This function helps users generate dots from an input polygon dataset intended for dot-density mapping.  Dots are placed randomly within polygons according to a given data:dots ratio; for example, a ratio of 100:1 for an input population value column will place approximately 1 dot in the polygon for every 100 people in the geographic unit.  Users can then map the dots using tools like ggplot2::geom_sf() or tmap::tm_dots()."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidycensus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.9.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-usage.html">Basic usage of tidycensus</a>
    </li>
    <li>
      <a href="../articles/spatial-data.html">Spatial data in tidycensus</a>
    </li>
    <li>
      <a href="../articles/margins-of-error.html">Margins of error in the ACS</a>
    </li>
    <li>
      <a href="../articles/other-datasets.html">Other Census Bureau datasets</a>
    </li>
    <li>
      <a href="../articles/pums-data.html">Working with Census microdata</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/walkerke/tidycensus" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert polygon geometry to dots for dot-density mapping</h1>
    <small class="dont-index">Source: <a href="https://github.com/walkerke/tidycensus/blob/HEAD/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
    <div class="hidden name"><code>as_dot_density.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Dot-density maps are a compelling alternative to choropleth maps for cartographic visualization of demographic data as they allow for representation of the internal heterogeneity of geographic units.  This function helps users generate dots from an input polygon dataset intended for dot-density mapping.  Dots are placed randomly within polygons according to a given data:dots ratio; for example, a ratio of 100:1 for an input population value column will place approximately 1 dot in the polygon for every 100 people in the geographic unit.  Users can then map the dots using tools like <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::geom_sf()</a></code> or <code><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html" class="external-link">tmap::tm_dots()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">as_dot_density</span><span class="op">(</span>
  <span class="va">input_data</span>,
  <span class="va">value</span>,
  <span class="va">values_per_dot</span>,
  group <span class="op">=</span> <span class="cn">NULL</span>,
  erase_water <span class="op">=</span> <span class="cn">FALSE</span>,
  area_threshold <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input_data</dt>
<dd><p>An input sf object of geometry type <code>POLYGON</code> or <code>MULTIPOLYGON</code> that includes some information that can be converted to dots.  While the function is designed for use with data acquired with the tidycensus package, it will work for arbitrary polygon datasets.</p></dd>
<dt>value</dt>
<dd><p>The value column to be used to determine the number of dots to generate. For tidycensus users, this will typically be the <code>"value"</code> column for decennial Census data or the <code>"estimate"</code> column for American Community Survey estimates.</p></dd>
<dt>values_per_dot</dt>
<dd><p>The number of values per dot; used to determine the output data:dots ratio. A value of 100 means that each dot will represent approximately 100 values in the value column.</p></dd>
<dt>group</dt>
<dd><p>A column in the dataset that identifies salient groups within which dots should be generated.  For a long-form tidycensus dataset, this will typically be the <code>"variable"</code> column or some derivative of it. The output dataset will be randomly shuffled to prevent "stacking" of groups in downstream dot-density maps.</p></dd>
<dt>erase_water</dt>
<dd><p>If <code>TRUE</code>, calls <code><a href="https://rdrr.io/pkg/tigris/man/erase_water.html" class="external-link">tigris::erase_water()</a></code> to remove water areas from the polygons prior to generating dots, allowing for dasymetric dot placement. This option is recommended if your location includes significant water area. If using this option, it is recommended that you first transform your data to a projected coordinate reference system using <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">sf::st_transform()</a></code> to improve performance. This argument only works for data in the United States.</p></dd>
<dt>area_threshold</dt>
<dd><p>The area percentile threshold to be used when erasing water; ranges from 0 (all water area included) to 1 (no water area included)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The original dataset but of geometry type <code>POINT</code>, with the number of point features corresponding to the given value:dot ratio for a given group.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>as_dot_density()</code> uses <code><a href="https://rdrr.io/pkg/terra/man/dots.html" class="external-link">terra::dots()</a></code> internally for fast creation of dots. As terra is not a hard dependency of the tidycensus package, users must first install terra before using this function.</p>
<p>The <code>erase_water</code> parameter will internally call <code><a href="https://rdrr.io/pkg/tigris/man/erase_water.html" class="external-link">tigris::erase_water()</a></code> to fetch water area for a given location in the United States and remove that water area from the polygons before placing dots in polygons. This will slow down performance of the function, but can improve cartographic accuracy in locations with significant water area. It is recommended that users transform their data into a projected coordinate reference system with <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">sf::st_transform()</a></code> prior to using this option in order to improve performance.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://walker-data.com/tidycensus/" class="external-link">tidycensus</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Identify variables for mapping</span></span>
<span class="r-in"><span class="va">race_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span class="r-in">  Hispanic <span class="op">=</span> <span class="st">"P2_002N"</span>,</span>
<span class="r-in">  White <span class="op">=</span> <span class="st">"P2_005N"</span>,</span>
<span class="r-in">  Black <span class="op">=</span> <span class="st">"P2_006N"</span>,</span>
<span class="r-in">  Asian <span class="op">=</span> <span class="st">"P2_008N"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Get data from tidycensus</span></span>
<span class="r-in"><span class="va">baltimore_race</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_decennial.html">get_decennial</a></span><span class="op">(</span></span>
<span class="r-in">  geography <span class="op">=</span> <span class="st">"tract"</span>,</span>
<span class="r-in">  variables <span class="op">=</span> <span class="va">race_vars</span>,</span>
<span class="r-in">  state <span class="op">=</span> <span class="st">"MD"</span>,</span>
<span class="r-in">  county <span class="op">=</span> <span class="st">"Baltimore city"</span>,</span>
<span class="r-in">  geometry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  year <span class="op">=</span> <span class="fl">2020</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Convert data to dots</span></span>
<span class="r-in"><span class="va">baltimore_dots</span> <span class="op">&lt;-</span> <span class="fu">as_dot_density</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">baltimore_race</span>,</span>
<span class="r-in">  value <span class="op">=</span> <span class="st">"value"</span>,</span>
<span class="r-in">  values_per_dot <span class="op">=</span> <span class="fl">100</span>,</span>
<span class="r-in">  group <span class="op">=</span> <span class="st">"variable"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use one set of polygon geometries as a base layer</span></span>
<span class="r-in"><span class="va">baltimore_base</span> <span class="op">&lt;-</span> <span class="va">baltimore_race</span><span class="op">[</span><span class="va">baltimore_race</span><span class="op">$</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"Hispanic"</span>, <span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Map with ggplot2</span></span>
<span class="r-in"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">baltimore_base</span>,</span>
<span class="r-in">          fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span class="r-in">          color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">baltimore_dots</span>,</span>
<span class="r-in">          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span>,</span>
<span class="r-in">          size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kyle Walker, Matt Herman.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

